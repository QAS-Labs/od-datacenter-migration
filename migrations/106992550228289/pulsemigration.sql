-- Manager us-east-1
select string_agg(id::text,',') from projects where clientid in (10699,25502,28289);
-- 96166,18792,61572,17305,70393,47448,54993,16990,17274,18911,36357,71023,97876,97592,97190,94771,96860,96117,81340,89191,95975,95974,95832,95803,94680,81092,93974,56557,93360,92924,92914,92744,84151,92369,92200,91999,91004,85762,85271,84813,84782,84651,84647,84642,84577,84455,84396,84107,84106,83937,82524,82014,81938,81768,81093,81078,81020,80947,80645,80488,78791,75105,72794,55766,57173,58008,41456,61277,59101,62004,60133,60944,61581,65505,62504,62505,66719,44783,62202,69746,97898,97894,97822,97578,97393,96169,96997,96985,96954,96900,96897,96896,95792,95790,95794,96014,96012,95927,95793,95791,95788,95787,95786,95112,94863,94846,94799,94798,94751,94693,94681,91785,93994,94078,94049,93769,91350,91984,91790,92080,91958,91230,91772,91779,91064,92313,91052,91781,91100,91787,91770,91439,92052,90495,91934,91258,92047,91085,91830,91780,91768,91440,91268,91669,91776,91075,91788,91354,88758,91503,91521,91791,91471,91497,91522,91528,91524,91446,93797,91475,91499,91569,91385,91502,91451,91572,91470,91348,91469,91339,91386,91450,91335,91527,91495,91498,91384,91332,91756,91308,91330,91563,91611,91284,91287,91501,91273,93770,91793,91792,91773,92054,92055,91500,91494,91526,91509,91448,91301,91460,91367,91477,91562,91443,91461,91465,91567,91491,91362,91447,91458,91511,93622,93550,93521,93520,93518,91516,91444,91364,91473,91456,91474,91492,91442,91529,91493,91565,91523,91383,91361,91455,91476,91457,91167,81971,85649,83737,92243,75235,81447,85123,87922,84618,91260,91371,85420,81480,73389,84150,86511,92143,91338,90979,81236,85814,91005,85042,83721,85893,92655,86462,91699,91758,88491,90861,91169,84836,92005,85819,87845,83227,91132,91479,87692,91043,85817,91134,84905,80466,85228,85650,85818,84110,92947,92528,73361,85168,88729,82436,92950,73359,73360,73358,78275,73323,82224,80919,92949,73362,84749,87916,87661,83840,87774,87800,81890,79940,87805,91983,91771,91668,91667,91666,91496,91468,91467,91449,91272,91271,91133,91084,91082,91081,88757,88732,85618,83960,82435,59589,59095,56821,58382

-- Manager us-east-1
select string_agg(userid::text,',') from client_users where clientid in (10699,25502,28289)
--121489,135467,49854,26751,18888,38920,121500,116689,49227,85632,45593,89281,6,16913,3,4,5,18890,18900,24850,59141,26748,42164,42165,18898,19633,56229,20010,20293,17190,35578,40659,18899,45342,18896,18897,106921,20015,26749,139896,73402,123747,139894,138530,119151,59557,62037,92710,98136,109255,139893,139895,139559,62490,78613,94918,48954,113250,78615,85621,94711,138420,65237,138418,64241,78614,136407,138523,99426,62489,113252,130534,138526,138538,138534,138547,131924,83343,138536,138535,138533,138548,138543,138542,138541,138540,138539,138537,138532,138531,138529,138528,138527,138525,138524,137352,138473,78612,138419,137355,138160,95716,138323,138322,94832,137359,110566,138050,103874,84797,79677,137356,137354,133752,97383,79676,95718,90930,137358,137362,137361,137360,137357,137353,137351,137112,137134,137133,137135,137110,137108,137114,137113,137111,137109,136806,136807,136805,136804,136285,48558,131927,105890,90493,64800,96732,136284,136283,136286,136287,49389,59446,105882,108896,135475,135477,135476,135474,135473,135472,135461,135460,135459,135458,135457,135292,135225,135226,105888,105892,105889,134708,134709,57843,134712,134717,134716,134715,134714,134713,134711,134710,134707,131956,133480,133479,84796,131952,103872,77287,102128,67394,49089,126300,131926,131923,61932,123037,132304,132303,132302,85618,131919,131955,131957,131954,131953,131951,131950,131925,131922,119155,102586,84124,78616,82912,51617,126834,117302,74117,113240,60201,67395,99141,98745,113514,74119,126304,126303,126302,126301,88374,105883,51616,108897,124120,57839,97382,123030,119150,120149,88378,121484,119149,109677,116544,70993,114446,47096,57360,78886,93962,79869,95165,100152,88026,119154,113712,79782,79870,85622,120383,92705,119127,120152,110168,120154,120153,120151,120150,120143,87914,117187,119152,119153,119148,119147,119128,81747,88375,91488,117177,117173,118087,114447,117480,117172,113245,115087,117479,117179,117178,117176,117175,117174,117159,62484,65243,78525,85620,81532,81749,78617,74019,84125,87538,83341,85617,49880,76287,92845,92844,77276,73394,62137,3,4,5,6,89495,87912,78324,88376,88381,71107,74118,58969,93963,95561,89748,49459,60221,80184,80185,80186,80187,61928,61931,60058,61933,62127,98417,98419,98418,105934,71933,91487,71935,71937,71940,74115,74116,60226,60203,71941,60220,60223,60202,60227,71942,74190,51686,70842,60720,62129,62132,62121,71954,62123,62124,62125,62133,62126,71944,62128,62136,62131,62135,62140,62134,62139,71962,57841,57845,57846,57849,62482,70622,70621,63933,93768,57848,61934,49090,71931,74328,71108,62122,62130,61930,60224,62283,51615,57840,68128,59447,72408,72435,72439,62483,72443,70990,70456,61929,62138,57844,72772,67393,60719,71932,57847,47803,49457,72436,71939,71936,71938,70987,70687,72901,72902,72903,72904,72434,70989,71930,95707,49458,71934,71928,71953,64698,65239,70992,57842,58968,95717,95719,95720,95721,72771,87913,65242,72440,71929,73188,116497,93769,95839,104303,96722,96617,95150,93961,99424,94712,57838,71943,93974,83103,98826,91645,113253,88021,65984,78611,96070,62615,102928,85823,96588,102302,112847,88022,103875,113497,72264,113513,109256,65241,103871,103873,96589,102585,85623,105878,105879,88380,51614,105880,104304,105884,105886,105891,101866,105887,105881,107025,105935,88020,105885,65240,92843,89496,48351,78610,72444,110167,70988,99423,90494,85619,85858,110363,70241,107525,70991,49388,95706,80188,99425,88379,85478,115086,91643,140624,140601,84159,140518,140432,139230,140322,140315,140314,140309,139892,130125,85733,139228,107378,140183,140155,140103,140051,140039,139984,81788,139939,102630,112396,106923,113848,107076,139732,139729,139727,139726,139712,111085,139702,139701,135107,106955,84156,82446,139540,130135,103079,109687,135714,138700,139478,139477,60805,130145,103188,94117,139197,109142,139069,138944,138875,138874,102625,115295,107078,138516,130134,107892,94118,113571,138640,84021,138569,138565,138512,109639,135067,138490,138438,85650,130136,102910,70757,113578,96459,70707,113931,91763,138223,134104,126347,82951,118397,138091,138082,138080,138078,114953,134770,137865,137841,120823,99593,102264,84163,112067,137605,107233,137599,126872,137475,137389,111397,137236,102907,84289,135558,137086,137077,137072,137070,137068,136853,97960,136802,136698,136697,133624,136691,88640,136687,136686,136685,70756,84018,135082,80819,135570,136444,112400,113555,136436,73391,133082,85638,134652,130143,109983,87462,130142,133078,135885,135882,91769,135717,128752,107219,126867,90160,114952,107380,128657,99623,124531,134723,90162,113341,109390,107218,114520,114508,85656,114513,103039,125250,105280,133628,82780,105391,92712,115756,107217,105272,124363,113052,84022,114509,105278,133763,87467,114507,133616,109308,116863,114515,109019,84161,106911,81787,112397,126845,135254,114659,87466,126869,107216,114517,109026,133441,105271,114617,125249,109301,126868,75629,116528,82781,90161,105392,114610,105277,82779,105270,103033,135282,135106,134722,134651,134341,134323,133764,133762,133676,133615,133614,133443,133442,133298,133033,132516,131698,131145,130982,130605,130291,128702,128070,128068,127179,127169,127168,126871,126870,126848,126837,126336,126187,126186,126185,125248,125247,125246,124680,122957,122924,122922,122775,121940,121918,121529,121280,120719,120397,119024,119001,118783,118569,117063,117030,116553,116529,116527,115826,115800,115761,115760,115757,115754,115512,115465,115326,115325,114959,114958,114957,114658,114656,114634,114633,114626,114624,114623,114622,114621,114620,114619,114618,114616,114609,114608,114521,114519,114632,113570,113596,137866,69772,79522,112070,113907,126847,114960,107374,113563,137863,112434,90173,113003,130137,84024,135069,88633,102043,138053,138493,114165,137594,135101,113568,107077,62119,82785,139350,88733,114974,109678,126849,124532,139340,138601,114518,107379,130138,118726,131968,135083,138744,114514,114512,114511,114510,114506,114505,114504,114503,114486,114400,114097,113849,113577,113576,113575,113574,113573,113572,113484,113400,113340,113339,113084,113051,113049,113047,113038,113006,113005,113004,112679,112678,112677,112398,112311,112068,112036,112026,111407,111066,111065,110951,110773,110648,110602,110173,110172,109981,109980,109979,109688,109680,109300,109038,109025,109024,109023,109022,109020,109018,108932,108919,107994,107855,107363,107236,107235,107234,107232,107222,106949,106915,106914,106912,106418,105471,105393,105279,105276,105275,105274,105273,104691,104681,85637,84631,84305,84304,84303,84300,84295,84162,84160,84157,84019,84017,84013,84011,84010,82920,82858,82796,82795,82794,82793,82792,82790,82789,82788,82786,82784,81908,81906,81786,81785,81757,81756,81628,81627,81626,80818,75631,75630,73392,73251,70755,70751,70706,69771,68192,63917,60808,60806,133077,93722,135118,135102,135076,135072,126846,135070,135066,134881,130139,134771,134729,134727,134237,133653,77701,79267,130141,130124,73167,122918,127030,119025,108734,101051,116891,106913,115755,82335,104347,104050,103570,103034,102908,102756,102653,102635,102634,102628,102626,102624,102623,102259,102154,101200,101199,100791,99440,99330,99329,98999,98782,98154,98051,97693,97548,96208,96063,94941,94940,94939,94938,94937,94936,94935,94934,94933,94932,94124,93308,91520,90508,90265,90264,90159,88388,87530,87527,87470,87469,87468,87461,87459,87458,87456,85857,82782,82783,82787,82791,84012,81625,82336,109977,3,4,5,6,84158,81117,91768,104522,92701,102627,70754,87463,81654,91519,101425,109303,91770,109309,111692,106910,106924,84023,69764,98551,97821,57570,76402,114516,87471,112071,112237,107882,103035,103036,103040,88390,102629,114682,87529,80817,107995,81789,115327,107220,98176,84020,109021,109975,88542,94116,114956,73168,107377,103,114954,113556

-- Pulse us-east-1
"c:\Program Files (x86)\pgAdmin 4\v3\runtime\psql.exe" -h session-production.clyko8fo6dqf.us-east-1.rds.amazonaws.com -d pulse -U root
\encoding UTF8

\copy (select * from pulse_project where qtestprojectid in (96166,18792,61572,17305,70393,47448,54993,16990,17274,18911,36357,71023,97876,97592,97190,94771,96860,96117,81340,89191,95975,95974,95832,95803,94680,81092,93974,56557,93360,92924,92914,92744,84151,92369,92200,91999,91004,85762,85271,84813,84782,84651,84647,84642,84577,84455,84396,84107,84106,83937,82524,82014,81938,81768,81093,81078,81020,80947,80645,80488,78791,75105,72794,55766,57173,58008,41456,61277,59101,62004,60133,60944,61581,65505,62504,62505,66719,44783,62202,69746,97898,97894,97822,97578,97393,96169,96997,96985,96954,96900,96897,96896,95792,95790,95794,96014,96012,95927,95793,95791,95788,95787,95786,95112,94863,94846,94799,94798,94751,94693,94681,91785,93994,94078,94049,93769,91350,91984,91790,92080,91958,91230,91772,91779,91064,92313,91052,91781,91100,91787,91770,91439,92052,90495,91934,91258,92047,91085,91830,91780,91768,91440,91268,91669,91776,91075,91788,91354,88758,91503,91521,91791,91471,91497,91522,91528,91524,91446,93797,91475,91499,91569,91385,91502,91451,91572,91470,91348,91469,91339,91386,91450,91335,91527,91495,91498,91384,91332,91756,91308,91330,91563,91611,91284,91287,91501,91273,93770,91793,91792,91773,92054,92055,91500,91494,91526,91509,91448,91301,91460,91367,91477,91562,91443,91461,91465,91567,91491,91362,91447,91458,91511,93622,93550,93521,93520,93518,91516,91444,91364,91473,91456,91474,91492,91442,91529,91493,91565,91523,91383,91361,91455,91476,91457,91167,81971,85649,83737,92243,75235,81447,85123,87922,84618,91260,91371,85420,81480,73389,84150,86511,92143,91338,90979,81236,85814,91005,85042,83721,85893,92655,86462,91699,91758,88491,90861,91169,84836,92005,85819,87845,83227,91132,91479,87692,91043,85817,91134,84905,80466,85228,85650,85818,84110,92947,92528,73361,85168,88729,82436,92950,73359,73360,73358,78275,73323,82224,80919,92949,73362,84749,87916,87661,83840,87774,87800,81890,79940,87805,91983,91771,91668,91667,91666,91496,91468,91467,91449,91272,91271,91133,91084,91082,91081,88757,88732,85618,83960,82435,59589,59095,56821,58382)) to 'pulse_project.dat'

\copy (select * from pulse_action where projectid in (select id from pulse_project where qtestprojectid in (96166,18792,61572,17305,70393,47448,54993,16990,17274,18911,36357,71023,97876,97592,97190,94771,96860,96117,81340,89191,95975,95974,95832,95803,94680,81092,93974,56557,93360,92924,92914,92744,84151,92369,92200,91999,91004,85762,85271,84813,84782,84651,84647,84642,84577,84455,84396,84107,84106,83937,82524,82014,81938,81768,81093,81078,81020,80947,80645,80488,78791,75105,72794,55766,57173,58008,41456,61277,59101,62004,60133,60944,61581,65505,62504,62505,66719,44783,62202,69746,97898,97894,97822,97578,97393,96169,96997,96985,96954,96900,96897,96896,95792,95790,95794,96014,96012,95927,95793,95791,95788,95787,95786,95112,94863,94846,94799,94798,94751,94693,94681,91785,93994,94078,94049,93769,91350,91984,91790,92080,91958,91230,91772,91779,91064,92313,91052,91781,91100,91787,91770,91439,92052,90495,91934,91258,92047,91085,91830,91780,91768,91440,91268,91669,91776,91075,91788,91354,88758,91503,91521,91791,91471,91497,91522,91528,91524,91446,93797,91475,91499,91569,91385,91502,91451,91572,91470,91348,91469,91339,91386,91450,91335,91527,91495,91498,91384,91332,91756,91308,91330,91563,91611,91284,91287,91501,91273,93770,91793,91792,91773,92054,92055,91500,91494,91526,91509,91448,91301,91460,91367,91477,91562,91443,91461,91465,91567,91491,91362,91447,91458,91511,93622,93550,93521,93520,93518,91516,91444,91364,91473,91456,91474,91492,91442,91529,91493,91565,91523,91383,91361,91455,91476,91457,91167,81971,85649,83737,92243,75235,81447,85123,87922,84618,91260,91371,85420,81480,73389,84150,86511,92143,91338,90979,81236,85814,91005,85042,83721,85893,92655,86462,91699,91758,88491,90861,91169,84836,92005,85819,87845,83227,91132,91479,87692,91043,85817,91134,84905,80466,85228,85650,85818,84110,92947,92528,73361,85168,88729,82436,92950,73359,73360,73358,78275,73323,82224,80919,92949,73362,84749,87916,87661,83840,87774,87800,81890,79940,87805,91983,91771,91668,91667,91666,91496,91468,91467,91449,91272,91271,91133,91084,91082,91081,88757,88732,85618,83960,82435,59589,59095,56821,58382))) to 'pulse_action.dat'

\copy (select * from pulse_constant where projectid in (select id from pulse_project where qtestprojectid in (96166,18792,61572,17305,70393,47448,54993,16990,17274,18911,36357,71023,97876,97592,97190,94771,96860,96117,81340,89191,95975,95974,95832,95803,94680,81092,93974,56557,93360,92924,92914,92744,84151,92369,92200,91999,91004,85762,85271,84813,84782,84651,84647,84642,84577,84455,84396,84107,84106,83937,82524,82014,81938,81768,81093,81078,81020,80947,80645,80488,78791,75105,72794,55766,57173,58008,41456,61277,59101,62004,60133,60944,61581,65505,62504,62505,66719,44783,62202,69746,97898,97894,97822,97578,97393,96169,96997,96985,96954,96900,96897,96896,95792,95790,95794,96014,96012,95927,95793,95791,95788,95787,95786,95112,94863,94846,94799,94798,94751,94693,94681,91785,93994,94078,94049,93769,91350,91984,91790,92080,91958,91230,91772,91779,91064,92313,91052,91781,91100,91787,91770,91439,92052,90495,91934,91258,92047,91085,91830,91780,91768,91440,91268,91669,91776,91075,91788,91354,88758,91503,91521,91791,91471,91497,91522,91528,91524,91446,93797,91475,91499,91569,91385,91502,91451,91572,91470,91348,91469,91339,91386,91450,91335,91527,91495,91498,91384,91332,91756,91308,91330,91563,91611,91284,91287,91501,91273,93770,91793,91792,91773,92054,92055,91500,91494,91526,91509,91448,91301,91460,91367,91477,91562,91443,91461,91465,91567,91491,91362,91447,91458,91511,93622,93550,93521,93520,93518,91516,91444,91364,91473,91456,91474,91492,91442,91529,91493,91565,91523,91383,91361,91455,91476,91457,91167,81971,85649,83737,92243,75235,81447,85123,87922,84618,91260,91371,85420,81480,73389,84150,86511,92143,91338,90979,81236,85814,91005,85042,83721,85893,92655,86462,91699,91758,88491,90861,91169,84836,92005,85819,87845,83227,91132,91479,87692,91043,85817,91134,84905,80466,85228,85650,85818,84110,92947,92528,73361,85168,88729,82436,92950,73359,73360,73358,78275,73323,82224,80919,92949,73362,84749,87916,87661,83840,87774,87800,81890,79940,87805,91983,91771,91668,91667,91666,91496,91468,91467,91449,91272,91271,91133,91084,91082,91081,88757,88732,85618,83960,82435,59589,59095,56821,58382))) to 'pulse_constant.dat'

\copy (select * from pulse_execution where actionid in (select id from pulse_action where projectid in (select id from pulse_project where qtestprojectid in (96166,18792,61572,17305,70393,47448,54993,16990,17274,18911,36357,71023,97876,97592,97190,94771,96860,96117,81340,89191,95975,95974,95832,95803,94680,81092,93974,56557,93360,92924,92914,92744,84151,92369,92200,91999,91004,85762,85271,84813,84782,84651,84647,84642,84577,84455,84396,84107,84106,83937,82524,82014,81938,81768,81093,81078,81020,80947,80645,80488,78791,75105,72794,55766,57173,58008,41456,61277,59101,62004,60133,60944,61581,65505,62504,62505,66719,44783,62202,69746,97898,97894,97822,97578,97393,96169,96997,96985,96954,96900,96897,96896,95792,95790,95794,96014,96012,95927,95793,95791,95788,95787,95786,95112,94863,94846,94799,94798,94751,94693,94681,91785,93994,94078,94049,93769,91350,91984,91790,92080,91958,91230,91772,91779,91064,92313,91052,91781,91100,91787,91770,91439,92052,90495,91934,91258,92047,91085,91830,91780,91768,91440,91268,91669,91776,91075,91788,91354,88758,91503,91521,91791,91471,91497,91522,91528,91524,91446,93797,91475,91499,91569,91385,91502,91451,91572,91470,91348,91469,91339,91386,91450,91335,91527,91495,91498,91384,91332,91756,91308,91330,91563,91611,91284,91287,91501,91273,93770,91793,91792,91773,92054,92055,91500,91494,91526,91509,91448,91301,91460,91367,91477,91562,91443,91461,91465,91567,91491,91362,91447,91458,91511,93622,93550,93521,93520,93518,91516,91444,91364,91473,91456,91474,91492,91442,91529,91493,91565,91523,91383,91361,91455,91476,91457,91167,81971,85649,83737,92243,75235,81447,85123,87922,84618,91260,91371,85420,81480,73389,84150,86511,92143,91338,90979,81236,85814,91005,85042,83721,85893,92655,86462,91699,91758,88491,90861,91169,84836,92005,85819,87845,83227,91132,91479,87692,91043,85817,91134,84905,80466,85228,85650,85818,84110,92947,92528,73361,85168,88729,82436,92950,73359,73360,73358,78275,73323,82224,80919,92949,73362,84749,87916,87661,83840,87774,87800,81890,79940,87805,91983,91771,91668,91667,91666,91496,91468,91467,91449,91272,91271,91133,91084,91082,91081,88757,88732,85618,83960,82435,59589,59095,56821,58382)))) to 'pulse_execution.dat'

\copy (select * from pulse_rule where projectid in (select id from pulse_project where qtestprojectid in (96166,18792,61572,17305,70393,47448,54993,16990,17274,18911,36357,71023,97876,97592,97190,94771,96860,96117,81340,89191,95975,95974,95832,95803,94680,81092,93974,56557,93360,92924,92914,92744,84151,92369,92200,91999,91004,85762,85271,84813,84782,84651,84647,84642,84577,84455,84396,84107,84106,83937,82524,82014,81938,81768,81093,81078,81020,80947,80645,80488,78791,75105,72794,55766,57173,58008,41456,61277,59101,62004,60133,60944,61581,65505,62504,62505,66719,44783,62202,69746,97898,97894,97822,97578,97393,96169,96997,96985,96954,96900,96897,96896,95792,95790,95794,96014,96012,95927,95793,95791,95788,95787,95786,95112,94863,94846,94799,94798,94751,94693,94681,91785,93994,94078,94049,93769,91350,91984,91790,92080,91958,91230,91772,91779,91064,92313,91052,91781,91100,91787,91770,91439,92052,90495,91934,91258,92047,91085,91830,91780,91768,91440,91268,91669,91776,91075,91788,91354,88758,91503,91521,91791,91471,91497,91522,91528,91524,91446,93797,91475,91499,91569,91385,91502,91451,91572,91470,91348,91469,91339,91386,91450,91335,91527,91495,91498,91384,91332,91756,91308,91330,91563,91611,91284,91287,91501,91273,93770,91793,91792,91773,92054,92055,91500,91494,91526,91509,91448,91301,91460,91367,91477,91562,91443,91461,91465,91567,91491,91362,91447,91458,91511,93622,93550,93521,93520,93518,91516,91444,91364,91473,91456,91474,91492,91442,91529,91493,91565,91523,91383,91361,91455,91476,91457,91167,81971,85649,83737,92243,75235,81447,85123,87922,84618,91260,91371,85420,81480,73389,84150,86511,92143,91338,90979,81236,85814,91005,85042,83721,85893,92655,86462,91699,91758,88491,90861,91169,84836,92005,85819,87845,83227,91132,91479,87692,91043,85817,91134,84905,80466,85228,85650,85818,84110,92947,92528,73361,85168,88729,82436,92950,73359,73360,73358,78275,73323,82224,80919,92949,73362,84749,87916,87661,83840,87774,87800,81890,79940,87805,91983,91771,91668,91667,91666,91496,91468,91467,91449,91272,91271,91133,91084,91082,91081,88757,88732,85618,83960,82435,59589,59095,56821,58382))) to 'pulse_rule.dat'

\copy (select * from pulse_rule_action where ruleid in (select id from pulse_rule where projectid in (select id from pulse_project where qtestprojectid in (96166,18792,61572,17305,70393,47448,54993,16990,17274,18911,36357,71023,97876,97592,97190,94771,96860,96117,81340,89191,95975,95974,95832,95803,94680,81092,93974,56557,93360,92924,92914,92744,84151,92369,92200,91999,91004,85762,85271,84813,84782,84651,84647,84642,84577,84455,84396,84107,84106,83937,82524,82014,81938,81768,81093,81078,81020,80947,80645,80488,78791,75105,72794,55766,57173,58008,41456,61277,59101,62004,60133,60944,61581,65505,62504,62505,66719,44783,62202,69746,97898,97894,97822,97578,97393,96169,96997,96985,96954,96900,96897,96896,95792,95790,95794,96014,96012,95927,95793,95791,95788,95787,95786,95112,94863,94846,94799,94798,94751,94693,94681,91785,93994,94078,94049,93769,91350,91984,91790,92080,91958,91230,91772,91779,91064,92313,91052,91781,91100,91787,91770,91439,92052,90495,91934,91258,92047,91085,91830,91780,91768,91440,91268,91669,91776,91075,91788,91354,88758,91503,91521,91791,91471,91497,91522,91528,91524,91446,93797,91475,91499,91569,91385,91502,91451,91572,91470,91348,91469,91339,91386,91450,91335,91527,91495,91498,91384,91332,91756,91308,91330,91563,91611,91284,91287,91501,91273,93770,91793,91792,91773,92054,92055,91500,91494,91526,91509,91448,91301,91460,91367,91477,91562,91443,91461,91465,91567,91491,91362,91447,91458,91511,93622,93550,93521,93520,93518,91516,91444,91364,91473,91456,91474,91492,91442,91529,91493,91565,91523,91383,91361,91455,91476,91457,91167,81971,85649,83737,92243,75235,81447,85123,87922,84618,91260,91371,85420,81480,73389,84150,86511,92143,91338,90979,81236,85814,91005,85042,83721,85893,92655,86462,91699,91758,88491,90861,91169,84836,92005,85819,87845,83227,91132,91479,87692,91043,85817,91134,84905,80466,85228,85650,85818,84110,92947,92528,73361,85168,88729,82436,92950,73359,73360,73358,78275,73323,82224,80919,92949,73362,84749,87916,87661,83840,87774,87800,81890,79940,87805,91983,91771,91668,91667,91666,91496,91468,91467,91449,91272,91271,91133,91084,91082,91081,88757,88732,85618,83960,82435,59589,59095,56821,58382)))) to 'pulse_rule_action.dat'

\copy (select * from pulse_trigger where projectid in (select id from pulse_project where qtestprojectid in (96166,18792,61572,17305,70393,47448,54993,16990,17274,18911,36357,71023,97876,97592,97190,94771,96860,96117,81340,89191,95975,95974,95832,95803,94680,81092,93974,56557,93360,92924,92914,92744,84151,92369,92200,91999,91004,85762,85271,84813,84782,84651,84647,84642,84577,84455,84396,84107,84106,83937,82524,82014,81938,81768,81093,81078,81020,80947,80645,80488,78791,75105,72794,55766,57173,58008,41456,61277,59101,62004,60133,60944,61581,65505,62504,62505,66719,44783,62202,69746,97898,97894,97822,97578,97393,96169,96997,96985,96954,96900,96897,96896,95792,95790,95794,96014,96012,95927,95793,95791,95788,95787,95786,95112,94863,94846,94799,94798,94751,94693,94681,91785,93994,94078,94049,93769,91350,91984,91790,92080,91958,91230,91772,91779,91064,92313,91052,91781,91100,91787,91770,91439,92052,90495,91934,91258,92047,91085,91830,91780,91768,91440,91268,91669,91776,91075,91788,91354,88758,91503,91521,91791,91471,91497,91522,91528,91524,91446,93797,91475,91499,91569,91385,91502,91451,91572,91470,91348,91469,91339,91386,91450,91335,91527,91495,91498,91384,91332,91756,91308,91330,91563,91611,91284,91287,91501,91273,93770,91793,91792,91773,92054,92055,91500,91494,91526,91509,91448,91301,91460,91367,91477,91562,91443,91461,91465,91567,91491,91362,91447,91458,91511,93622,93550,93521,93520,93518,91516,91444,91364,91473,91456,91474,91492,91442,91529,91493,91565,91523,91383,91361,91455,91476,91457,91167,81971,85649,83737,92243,75235,81447,85123,87922,84618,91260,91371,85420,81480,73389,84150,86511,92143,91338,90979,81236,85814,91005,85042,83721,85893,92655,86462,91699,91758,88491,90861,91169,84836,92005,85819,87845,83227,91132,91479,87692,91043,85817,91134,84905,80466,85228,85650,85818,84110,92947,92528,73361,85168,88729,82436,92950,73359,73360,73358,78275,73323,82224,80919,92949,73362,84749,87916,87661,83840,87774,87800,81890,79940,87805,91983,91771,91668,91667,91666,91496,91468,91467,91449,91272,91271,91133,91084,91082,91081,88757,88732,85618,83960,82435,59589,59095,56821,58382))) to 'pulse_trigger.dat'

\copy (select * from pulse_user where qtestuserid in (121489,135467,49854,26751,18888,38920,121500,116689,49227,85632,45593,89281,6,16913,3,4,5,18890,18900,24850,59141,26748,42164,42165,18898,19633,56229,20010,20293,17190,35578,40659,18899,45342,18896,18897,106921,20015,26749,139896,73402,123747,139894,138530,119151,59557,62037,92710,98136,109255,139893,139895,139559,62490,78613,94918,48954,113250,78615,85621,94711,138420,65237,138418,64241,78614,136407,138523,99426,62489,113252,130534,138526,138538,138534,138547,131924,83343,138536,138535,138533,138548,138543,138542,138541,138540,138539,138537,138532,138531,138529,138528,138527,138525,138524,137352,138473,78612,138419,137355,138160,95716,138323,138322,94832,137359,110566,138050,103874,84797,79677,137356,137354,133752,97383,79676,95718,90930,137358,137362,137361,137360,137357,137353,137351,137112,137134,137133,137135,137110,137108,137114,137113,137111,137109,136806,136807,136805,136804,136285,48558,131927,105890,90493,64800,96732,136284,136283,136286,136287,49389,59446,105882,108896,135475,135477,135476,135474,135473,135472,135461,135460,135459,135458,135457,135292,135225,135226,105888,105892,105889,134708,134709,57843,134712,134717,134716,134715,134714,134713,134711,134710,134707,131956,133480,133479,84796,131952,103872,77287,102128,67394,49089,126300,131926,131923,61932,123037,132304,132303,132302,85618,131919,131955,131957,131954,131953,131951,131950,131925,131922,119155,102586,84124,78616,82912,51617,126834,117302,74117,113240,60201,67395,99141,98745,113514,74119,126304,126303,126302,126301,88374,105883,51616,108897,124120,57839,97382,123030,119150,120149,88378,121484,119149,109677,116544,70993,114446,47096,57360,78886,93962,79869,95165,100152,88026,119154,113712,79782,79870,85622,120383,92705,119127,120152,110168,120154,120153,120151,120150,120143,87914,117187,119152,119153,119148,119147,119128,81747,88375,91488,117177,117173,118087,114447,117480,117172,113245,115087,117479,117179,117178,117176,117175,117174,117159,62484,65243,78525,85620,81532,81749,78617,74019,84125,87538,83341,85617,49880,76287,92845,92844,77276,73394,62137,3,4,5,6,89495,87912,78324,88376,88381,71107,74118,58969,93963,95561,89748,49459,60221,80184,80185,80186,80187,61928,61931,60058,61933,62127,98417,98419,98418,105934,71933,91487,71935,71937,71940,74115,74116,60226,60203,71941,60220,60223,60202,60227,71942,74190,51686,70842,60720,62129,62132,62121,71954,62123,62124,62125,62133,62126,71944,62128,62136,62131,62135,62140,62134,62139,71962,57841,57845,57846,57849,62482,70622,70621,63933,93768,57848,61934,49090,71931,74328,71108,62122,62130,61930,60224,62283,51615,57840,68128,59447,72408,72435,72439,62483,72443,70990,70456,61929,62138,57844,72772,67393,60719,71932,57847,47803,49457,72436,71939,71936,71938,70987,70687,72901,72902,72903,72904,72434,70989,71930,95707,49458,71934,71928,71953,64698,65239,70992,57842,58968,95717,95719,95720,95721,72771,87913,65242,72440,71929,73188,116497,93769,95839,104303,96722,96617,95150,93961,99424,94712,57838,71943,93974,83103,98826,91645,113253,88021,65984,78611,96070,62615,102928,85823,96588,102302,112847,88022,103875,113497,72264,113513,109256,65241,103871,103873,96589,102585,85623,105878,105879,88380,51614,105880,104304,105884,105886,105891,101866,105887,105881,107025,105935,88020,105885,65240,92843,89496,48351,78610,72444,110167,70988,99423,90494,85619,85858,110363,70241,107525,70991,49388,95706,80188,99425,88379,85478,115086,91643,140624,140601,84159,140518,140432,139230,140322,140315,140314,140309,139892,130125,85733,139228,107378,140183,140155,140103,140051,140039,139984,81788,139939,102630,112396,106923,113848,107076,139732,139729,139727,139726,139712,111085,139702,139701,135107,106955,84156,82446,139540,130135,103079,109687,135714,138700,139478,139477,60805,130145,103188,94117,139197,109142,139069,138944,138875,138874,102625,115295,107078,138516,130134,107892,94118,113571,138640,84021,138569,138565,138512,109639,135067,138490,138438,85650,130136,102910,70757,113578,96459,70707,113931,91763,138223,134104,126347,82951,118397,138091,138082,138080,138078,114953,134770,137865,137841,120823,99593,102264,84163,112067,137605,107233,137599,126872,137475,137389,111397,137236,102907,84289,135558,137086,137077,137072,137070,137068,136853,97960,136802,136698,136697,133624,136691,88640,136687,136686,136685,70756,84018,135082,80819,135570,136444,112400,113555,136436,73391,133082,85638,134652,130143,109983,87462,130142,133078,135885,135882,91769,135717,128752,107219,126867,90160,114952,107380,128657,99623,124531,134723,90162,113341,109390,107218,114520,114508,85656,114513,103039,125250,105280,133628,82780,105391,92712,115756,107217,105272,124363,113052,84022,114509,105278,133763,87467,114507,133616,109308,116863,114515,109019,84161,106911,81787,112397,126845,135254,114659,87466,126869,107216,114517,109026,133441,105271,114617,125249,109301,126868,75629,116528,82781,90161,105392,114610,105277,82779,105270,103033,135282,135106,134722,134651,134341,134323,133764,133762,133676,133615,133614,133443,133442,133298,133033,132516,131698,131145,130982,130605,130291,128702,128070,128068,127179,127169,127168,126871,126870,126848,126837,126336,126187,126186,126185,125248,125247,125246,124680,122957,122924,122922,122775,121940,121918,121529,121280,120719,120397,119024,119001,118783,118569,117063,117030,116553,116529,116527,115826,115800,115761,115760,115757,115754,115512,115465,115326,115325,114959,114958,114957,114658,114656,114634,114633,114626,114624,114623,114622,114621,114620,114619,114618,114616,114609,114608,114521,114519,114632,113570,113596,137866,69772,79522,112070,113907,126847,114960,107374,113563,137863,112434,90173,113003,130137,84024,135069,88633,102043,138053,138493,114165,137594,135101,113568,107077,62119,82785,139350,88733,114974,109678,126849,124532,139340,138601,114518,107379,130138,118726,131968,135083,138744,114514,114512,114511,114510,114506,114505,114504,114503,114486,114400,114097,113849,113577,113576,113575,113574,113573,113572,113484,113400,113340,113339,113084,113051,113049,113047,113038,113006,113005,113004,112679,112678,112677,112398,112311,112068,112036,112026,111407,111066,111065,110951,110773,110648,110602,110173,110172,109981,109980,109979,109688,109680,109300,109038,109025,109024,109023,109022,109020,109018,108932,108919,107994,107855,107363,107236,107235,107234,107232,107222,106949,106915,106914,106912,106418,105471,105393,105279,105276,105275,105274,105273,104691,104681,85637,84631,84305,84304,84303,84300,84295,84162,84160,84157,84019,84017,84013,84011,84010,82920,82858,82796,82795,82794,82793,82792,82790,82789,82788,82786,82784,81908,81906,81786,81785,81757,81756,81628,81627,81626,80818,75631,75630,73392,73251,70755,70751,70706,69771,68192,63917,60808,60806,133077,93722,135118,135102,135076,135072,126846,135070,135066,134881,130139,134771,134729,134727,134237,133653,77701,79267,130141,130124,73167,122918,127030,119025,108734,101051,116891,106913,115755,82335,104347,104050,103570,103034,102908,102756,102653,102635,102634,102628,102626,102624,102623,102259,102154,101200,101199,100791,99440,99330,99329,98999,98782,98154,98051,97693,97548,96208,96063,94941,94940,94939,94938,94937,94936,94935,94934,94933,94932,94124,93308,91520,90508,90265,90264,90159,88388,87530,87527,87470,87469,87468,87461,87459,87458,87456,85857,82782,82783,82787,82791,84012,81625,82336,109977,3,4,5,6,84158,81117,91768,104522,92701,102627,70754,87463,81654,91519,101425,109303,91770,109309,111692,106910,106924,84023,69764,98551,97821,57570,76402,114516,87471,112071,112237,107882,103035,103036,103040,88390,102629,114682,87529,80817,107995,81789,115327,107220,98176,84020,109021,109975,88542,94116,114956,73168,107377,103,114954,113556)) to 'pulse_user.dat'

-- Pulse eu-west-1
"c:\Program Files (x86)\pgAdmin 4\v3\runtime\psql.exe" -h session-production.cs2eia7pt6r3.eu-west-1.rds.amazonaws.com -d pulse -U root
\encoding UTF8

create schema if not exists ztmpclientmigration;

CREATE TABLE ztmpclientmigration.pulse_action
(
    id uuid,
    projectid uuid,
    name character varying(500),
    description text,
    code text,
    createdat timestamp with time zone
);

CREATE TABLE ztmpclientmigration.pulse_constant
(
    id uuid,
    projectid uuid,
    name character varying(500),
    hidden boolean,
    value character varying(2000),
    createdat timestamp with time zone
);

CREATE TABLE ztmpclientmigration.pulse_execution
(
    id uuid,
    actionid uuid,
    status execution_status,
    payload json,
    start bigint,
    "end" bigint,
    "out" text,
    err text,
    result json,
    createdat timestamp with time zone
);

CREATE TABLE ztmpclientmigration.pulse_project
(
    id uuid,
    qtestprojectid bigint,
    name character varying(500)
);

CREATE TABLE ztmpclientmigration.pulse_rule
(
    id uuid,
    projectid uuid,
    triggerid uuid,
    name character varying(500),
    active boolean,
    tags json,
    createdat timestamp with time zone
);


CREATE TABLE ztmpclientmigration.pulse_rule_action
(
    ruleid uuid,
    actionid uuid
);


CREATE TABLE ztmpclientmigration.pulse_trigger
(
    id uuid,
    projectid uuid,
    name character varying(500),
    uuid uuid,
    objectid character varying(24),
    createdat timestamp with time zone
);

CREATE TABLE ztmpclientmigration.pulse_user
(
    id uuid,
    qtestuserid bigint,
    username character varying(500),
    settings json
);

\copy ztmpclientmigration.pulse_action from 'pulse_action.dat'
\copy ztmpclientmigration.pulse_constant from 'pulse_constant.dat'
\copy ztmpclientmigration.pulse_execution from 'pulse_execution.dat'
\copy ztmpclientmigration.pulse_project from 'pulse_project.dat'
\copy ztmpclientmigration.pulse_rule from 'pulse_rule.dat'
\copy ztmpclientmigration.pulse_rule_action from 'pulse_rule_action.dat'
\copy ztmpclientmigration.pulse_trigger from 'pulse_trigger.dat'
\copy ztmpclientmigration.pulse_user from 'pulse_user.dat'

alter table public.pulse_action add column if not exists fromid uuid null, add column if not exists fromclientid int8 null;
alter table public.pulse_constant add column if not exists fromid uuid null, add column if not exists fromclientid int8 null;
alter table public.pulse_execution add column if not exists fromid uuid null, add column if not exists fromclientid int8 null;
alter table public.pulse_project add column if not exists fromid uuid null, add column if not exists fromclientid int8 null;
alter table public.pulse_rule add column if not exists fromid uuid null, add column if not exists fromclientid int8 null;
alter table public.pulse_rule_action add column if not exists fromid uuid null, add column if not exists fromclientid int8 null;
alter table public.pulse_trigger add column if not exists fromid uuid null, add column if not exists fromclientid int8 null;
alter table public.pulse_user add column if not exists fromid uuid null, add column if not exists fromclientid int8 null;

alter table public.pulse_action alter column fromid TYPE uuid USING null;
alter table public.pulse_constant alter column fromid TYPE uuid USING null;
alter table public.pulse_execution alter column fromid TYPE uuid USING null;
alter table public.pulse_project alter column fromid TYPE uuid USING null;
alter table public.pulse_rule alter column fromid TYPE uuid USING null;
alter table public.pulse_rule_action alter column fromid TYPE uuid USING null;
alter table public.pulse_trigger alter column fromid TYPE uuid USING null;
alter table public.pulse_user alter column fromid TYPE uuid USING null;

-- Manager db
\copy (SELECT fromclientid, id, fromid FROM users WHERE fromclientid in (10699,25502,28289) and fromid is not null and id != fromid) to 'newid_users.dat'
-- 0 rows
\copy (SELECT clientid, id, fromid FROM projects WHERE clientid in (10699,25502,28289) and fromid is not null and id != fromid) to 'newid_projects.dat'



-- Pulse
create table if not exists ztmpclientmigration.newid_projects (
    clientid bigint NOT NULL,
    id bigint NOT NULL,
    fromid bigint NOT NULL,
    constraint pk_newid_projects PRIMARY KEY (id)
);
\copy ztmpclientmigration.newid_projects from 'newid_projects.dat'
update ztmpclientmigration.pulse_project a
set qtestprojectid = z.id
from ztmpclientmigration.newid_projects z
where a.qtestprojectid = z.fromid
and z.id != z.fromid;


select * from pulse_constant where projectid in (
select d.id from ztmpclientmigration.pulse_project s
inner join public.pulse_project d on s.qtestprojectid = d.qtestprojectid);
-- 0
select * from pulse_action where projectid in (
select d.id from ztmpclientmigration.pulse_project s
inner join public.pulse_project d on s.qtestprojectid = d.qtestprojectid);
-- 0
select * from pulse_trigger where projectid in (
select d.id from ztmpclientmigration.pulse_project s
inner join public.pulse_project d on s.qtestprojectid = d.qtestprojectid);
-- 0
select * from pulse_rule where projectid in (
select d.id from ztmpclientmigration.pulse_project s
inner join public.pulse_project d on s.qtestprojectid = d.qtestprojectid);
-- 0
create schema if not exists backup;
create table backup.pulse_project_20191222 as
select * from public.pulse_project where id in (
select d.id from ztmpclientmigration.pulse_project s
inner join public.pulse_project d on s.qtestprojectid = d.qtestprojectid);
begin;
delete from public.pulse_project where id in (select id from backup.pulse_project_20191222);
-- verify select d.id from ztmpclientmigration.pulse_project s inner join public.pulse_project d on s.qtestprojectid = d.qtestprojectid
commit;

insert into public.pulse_user
select s.*,s.id,106992550228289 from ztmpclientmigration.pulse_user s
left join public.pulse_user d on s.qtestuserid = d.qtestuserid
where d.id is null;
insert into public.pulse_project
select s.*,s.id,106992550228289 from ztmpclientmigration.pulse_project s
left join public.pulse_project d on s.qtestprojectid = d.qtestprojectid
where d.id is null;
insert into public.pulse_constant
select *,id,106992550228289 from ztmpclientmigration.pulse_constant;
insert into public.pulse_action
select *,id,106992550228289 from ztmpclientmigration.pulse_action;
insert into public.pulse_trigger
select *,id,106992550228289 from ztmpclientmigration.pulse_trigger;
insert into public.pulse_rule
select *,id,106992550228289 from ztmpclientmigration.pulse_rule;
insert into public.pulse_rule_action
select *,null,106992550228289 from ztmpclientmigration.pulse_rule_action;
insert into public.pulse_execution
select *,id,106992550228289 from ztmpclientmigration.pulse_execution;